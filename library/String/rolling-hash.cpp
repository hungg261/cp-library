#define int long long
vector<long long> HASH_MODS = {
    1016426483LL,1052391971LL,1055604587LL,1071275489LL,1073865521LL,1088824091LL,1097195833LL,1098100813LL,1102079623LL,1111388491LL,1122479861LL,1124614159LL,1125143441LL,1129073237LL,1139517839LL,1149503423LL,1150558511LL,1178026901LL,1201680127LL,1202758027LL,
    1216642003LL,1217622397LL,1220427953LL,1232080459LL,1233638011LL,1250735573LL,1251409213LL,1279822651LL,1297303321LL,1298024939LL,1302829637LL,1307428319LL,1322271911LL,1323373097LL,1328621599LL,1347569983LL,1394771167LL,1410726313LL,1416081071LL,1417231097LL,
    1429586341LL,1440972707LL,1475317127LL,1482781607LL,1493219881LL,1494068419LL,1525650439LL,1529599081LL,1540840879LL,1542500837LL,1556401661LL,1563141529LL,1581064411LL,1582460401LL,1583510429LL,1596452401LL,1606424951LL,1607550401LL,1615853731LL,1619960123LL,
    1621995163LL,1625976907LL,1641302249LL,1674540887LL,1678789921LL,1683453899LL,1691307077LL,1692177479LL,1706958853LL,1707577889LL,1718079767LL,1755616721LL,1797932473LL,1803300077LL,1813623113LL,1817989099LL,1853324867LL,1853438791LL,1856770483LL,1860289547LL,
    1873938359LL,1878669901LL,1894242743LL,1914568693LL,1919044657LL,1926887159LL,1930412273LL,1932582391LL,1948974451LL,1962414317LL,1968629321LL,2009718001LL,2043284513LL,2056277851LL,2070167861LL,2077523537LL,2080703543LL,2101312529LL,2129516099LL,2141200927LL
};
mt19937_64 rng(chrono::steady_clock::now().time_since_epoch().count());

struct Hash{
    int BASE, MOD;
    vector<int> hashes;
    vector<int> powhash;

    Hash() = default;
    Hash(string S, int _base = 0, int _mod = 0): BASE(_base), MOD(_mod){
        if(!MOD) MOD = HASH_MODS[rng() % HASH_MODS.size()];
        if(!BASE) BASE = (rng() % (MOD - 256) + 256) | 1;

        int sz = S.size();
        hashes.resize(sz + 1);
        powhash.resize(sz + 1);

        S = "#" + S;
        powhash[0] = 1;
        hashes[0] = 0;
        for(int i = 1; i <= sz; ++i){
            hashes[i] = (hashes[i - 1] * BASE + (unsigned char)S[i]) % MOD;
            powhash[i] = powhash[i - 1] * BASE % MOD;
        }
    }

    int get(int l, int r){
        return ((hashes[r] - hashes[l - 1] * powhash[r - l + 1]) % MOD + MOD) % MOD;
    }
};

struct DHash{
    Hash hash1, hash2;

    DHash(const string& S){
        hash1 = Hash(S);
        hash2 = Hash(S);
        while(hash2.MOD == hash1.MOD) hash2 = Hash(S);
    }

    pair<int, int> get(int l, int r){
        return {hash1.get(l, r), hash2.get(l, r)};
    }
};